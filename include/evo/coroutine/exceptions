// -*- C++ -*-
// Date:   Fri May 09 22:50:47 2025
// Mail:   lunar_ubuntu@qq.com
// Author: https://github.com/xiaoqixian

#pragma once

#include "evo/result"
#include <cstring>
#include <type_traits>
namespace evo::coro {

template <typename T>
class UnixIOResult: public Result<T, int> {
public:
  inline T unwrap_or_throw() {
    if (this->is_err()) {
      throw std::runtime_error(std::strerror(this->unchecked_unwrap_err()));
    } else {
      return std::move(*this).unchecked_unwrap();
    }
  }

  inline int unwrap_anyway() 
    requires std::is_same_v<T, int>
  {
    return this->is_ok() ? this->unchecked_unwrap() : this->unchecked_unwrap_err();
  }
};

} // namespace evo::coro

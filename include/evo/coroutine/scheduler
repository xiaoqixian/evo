// -*- C++ -*-
// Date:   Tue May 06 20:55:10 2025
// Mail:   lunar_ubuntu@qq.com
// Author: https://github.com/xiaoqixian

#pragma once

#include "evo/coroutine/context"
#include "evo/coroutine/raw_task"
#include "evo/debug"

namespace evo::coro {

class LocalScheduler {
  using task_t = RawTask;
public:
  void schedule(task_t task) {
    // LOG_TRACE("LocalScheduler schedule a task");
    GLOBAL_CONTEXT.with([task = std::move(task)](auto& ctx) {
      ctx.push(std::move(task));
    });
  }

  void yield_now(task_t task) {
    // LOG_TRACE("LocalScheduler yield a task");
    GLOBAL_CONTEXT.with([task](auto& ctx) {
      ctx.push_front(task);
    });
  }
};

} // namespace evo::coro

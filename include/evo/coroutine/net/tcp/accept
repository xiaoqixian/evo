// -*- C++ -*-
// Date:   Sat May 03 22:33:53 2025
// Mail:   lunar_ubuntu@qq.com
// Author: https://github.com/xiaoqixian

#pragma once

#include "evo/coroutine/fd"
#include <cerrno>
#include <cstring>
#include <sys/socket.h>
#include <tuple>

namespace evo::coro {

namespace net {

class Accept {
  Fd fd_;
public:
  Accept(Fd const& fd): fd_(fd) {}

  using return_type = int;
  inline auto interest() -> std::tuple<int, IODirection> {
    return std::make_tuple(fd_, IODirection::read());
  }

  inline int invoke() {
    return ::accept(fd_, nullptr, nullptr);
  }
};

} // namespace net

} // namespace evo::coro::net
